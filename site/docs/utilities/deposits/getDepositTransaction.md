---
head:
  - - meta
    - property: og:title
      content: getDepositTransaction
  - - meta
    - name: description
      content: Returns a deposit transaction from a TransactionDeposited event and sourcehash or logIndex and l1BlockHash.
---

# getDepositTransaction

Returns a [DepositTransaction](/docs/glossary/types#deposittransaction) from a [TransactionDepositedEvent](/docs/glossary/types#transasctiondepositedevent) and [sourceHash](/docs/glossary/types#sourcehash) or logIndex, L1 block hash and [SourceHashDomain](/docs/glossary/types#sourcehashdomain).

Internally, if [`sourceHash`](#sourcehash-optional) not provided, will call [`getSourceHash({ domain, logIndex, l1BlockHash })`](docs/utilities/deposits/getSourceHash).

## Import

```ts
import { getDepositTransaction } from 'op-viem'
```

## Usage

```ts
import { getDepositTransaction } from 'viem'

const event: TransactionDepositedEvent = {
  eventName: 'TransactionDeposited',
  args: {
    from: '0xbc3ed6B537f2980e66f396Fe14210A56ba3f72C4',
    to: '0xbc3ed6B537f2980e66f396Fe14210A56ba3f72C4',
    version: 0n,
    opaqueData:
      '0x0000000000000000000000000000000000000000000000000de0b6b3a76400000000000000000000000000000000000000000000000000000000000000000001000000000000526c0000',
  },
}
const logIndex = 196
const blockHash =
  '0x9ba3933dc6ce43c145349770a39c30f9b647f17668f004bd2e05c80a2e7262f7'

// without known source hash
const deposit = getDepositTransaction({
  event: event,
  logIndex: logIndex,
  l1BlockHash: blockHash,
})

// with known source hash
const deposit = getDepositTransaction({
  event: event,
  sourceHash:
    '0xd0868c8764d81f1749edb7dec4a550966963540d9fe50aefce8cdb38ea7b2213',
})
```

## Returns

[`DepositTransaction`](/docs/glossary/types#deposittransaction)

The L2 deposit transaction generated by the L1 transaction. Can be rlp encoded and hashed to get the L2 transaction hash.

## Parameters

### event

- **Type:** [`TransactionDepositedEvent`](/docs/glossary/types#transactiondepositedevent)

### sourceHash (optional)

- **Type:** [sourceHash](/docs/glossary/types#sourcehash)

Can be provided instead of [l1BlockHash](#l1blockhash-optional) and [logIndex](#logindex-optional).

### logIndex (optional)

- **Type:** `number`

The index of the given [`TransactionDepositedEvent`](/docs/glossary/types#transactiondepositedevent) log among all events emitted in the same L1 block. MUST be provied with [l1BlockHash](#l1BlockHash-optional) if sourceHash not passed.

### l1BlockHash (optional)

- **Type:** `Hex`

The blockhash of the L1 block in which the passed [event](#event) was emitted. MUST be provied with [logIndex](#logIndex-optional) if sourceHash not passed.

### domain (optional)

- **Type:** [SourceHashDomain](/docs/glossary/types#SourceHashDomain)
- **Default** `SourceHashDomain.UserDeposit`

Note: only `SourceHashDomain.UserDeposit` currently supported.
